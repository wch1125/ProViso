import{j as e,f as Z,g as W}from"./index-MBjjlW4L.js";import{r as d,h as ee,L as $}from"./vendor-react-C-GM1j7h.js";import{B as g,a as L,C as P,b as M}from"./Card-BxcNJRAC.js";import{s as te,X as R,t as ae,Z as se,T as re,c as ne,a as G,u as E,m as O,r as _,v as ie,w as le,x as oe,b as ce,y as de,F as H,B as V,D as me,z as xe,R as ue,g as he,J as pe,d as ge,K as ve,f as fe}from"./vendor-icons-SDImLkab.js";import{I as D,S as q,N as je,a as be}from"./Select-BdyKdwLE.js";import{S as B,A as Ne}from"./ActivityFeed-DS67lscO.js";import{M as ye}from"./Modal-D8OJ1k9Q.js";import{T as Ce}from"./TopNav-CGMpTtf7.js";import"./vendor-charts-DE_Rm1Qj.js";function we({searchValue:m,onSearchChange:x,searchPlaceholder:s="Search...",filters:n,onFilterChange:a,activeFilters:j={},className:b=""}){const v=Object.values(j).some(u=>u&&u!=="all");return e.jsxs("div",{className:`flex flex-wrap items-center gap-3 ${b}`,children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[e.jsx(te,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-text-muted"}),e.jsx("input",{type:"text",value:m,onChange:u=>x(u.target.value),placeholder:s,className:`
            w-full pl-10 pr-10 py-2
            bg-surface-2 border border-border-DEFAULT rounded-lg
            text-text-primary placeholder-text-muted
            focus:outline-none focus:ring-2 focus:ring-gold-500 focus:border-transparent
            transition-all
          `}),m&&e.jsx("button",{onClick:()=>x(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-text-muted hover:text-text-primary transition-colors",children:e.jsx(R,{className:"w-4 h-4"})})]}),n&&n.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[n.map(u=>e.jsx(Te,{filter:u,value:j[u.id]||"all",onChange:N=>a==null?void 0:a(u.id,N)},u.id)),v&&e.jsxs("button",{onClick:()=>{n.forEach(u=>a==null?void 0:a(u.id,"all"))},className:"flex items-center gap-1 px-3 py-2 text-sm text-text-tertiary hover:text-text-primary transition-colors",children:[e.jsx(R,{className:"w-3 h-3"}),"Clear"]})]})]})}function Te({filter:m,value:x,onChange:s}){const n=x&&x!=="all";return e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:x,onChange:a=>s(a.target.value),className:`
          appearance-none
          px-3 py-2 pr-8
          text-sm font-medium rounded-lg
          border transition-all cursor-pointer
          focus:outline-none focus:ring-2 focus:ring-gold-500
          ${n?"bg-gold-500/10 border-gold-500/30 text-gold-500":"bg-surface-2 border-border-DEFAULT text-text-secondary hover:text-text-primary hover:border-border-strong"}
        `,children:[e.jsxs("option",{value:"all",children:[m.label,": All"]}),m.options.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]}),e.jsx(ae,{className:"absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-text-muted pointer-events-none"})]})}function Se({options:m,value:x,onChange:s,className:n=""}){return e.jsx("div",{className:`flex flex-wrap gap-2 ${n}`,children:m.map(a=>e.jsxs("button",{onClick:()=>s(a.id),className:`
            px-3 py-1.5 text-sm font-medium rounded-full
            transition-all
            ${x===a.id?"bg-gold-500 text-surface-0":"bg-surface-2 text-text-tertiary hover:text-text-primary hover:bg-surface-3"}
          `,children:[a.label,a.count!==void 0&&e.jsxs("span",{className:`ml-1.5 ${x===a.id?"text-gold-200":"text-text-muted"}`,children:["(",a.count,")"]})]},a.id))})}const De=[{id:"corporate-revolver",name:"Corporate Revolving Credit Facility",description:"Standard corporate revolver with maintenance covenants, investment and restricted payment baskets, grower/builder baskets, and events of default.",industry:"Corporate",complexity:"standard",icon:"Building2",features:["Leverage & interest coverage covenants","Equity cure rights","Fixed, grower, and builder baskets","Negative covenants with exceptions","Payment, covenant, and cross-default events"],defaultValues:{borrowerName:"Acme Corp",facilityAmount:5e8,maxLeverage:4.5,minInterestCoverage:2.5,hasLiquidityCovenant:!0,minLiquidity:15e6,covenantFrequency:"QUARTERLY",hasCureRight:!0,cureMaxUses:3,cureMaxAmount:2e7,generalInvestmentBasket:25e6,restrictedPaymentsBasket:1e7,rpBasketAssetPercentage:5,capExBasket:2e7,permittedAcquisitionBasket:75e6,hasGrowerBasket:!0,growerPercentage:15,growerFloor:15e6,hasBuilderBasket:!0,builderPercentage:50,builderStarting:1e7,builderMaximum:75e6,paymentDefaultGracePeriod:5,covenantDefaultGracePeriod:30,crossDefaultThreshold:1e7}},{id:"term-loan-b",name:"Term Loan B (Covenant-Lite)",description:"Leveraged finance term loan with incurrence-only covenants. No maintenance tests — covenants only checked on specific actions.",industry:"Leveraged Finance",complexity:"standard",icon:"TrendingUp",features:["Incurrence-only covenants (no maintenance)","Leverage & secured leverage ratio tests","Fixed charge coverage for restricted payments","Builder basket (Available Amount)","Change of control event of default"],defaultValues:{borrowerName:"Acme Holdings LLC",facilityAmount:75e7,incurrenceLeverage:5,securedLeverageCap:3.5,fixedChargeCoverage:2,generalDebtBasket:1e8,rpCapacityFixed:5e7,rpCapacityPercentage:15,investmentBasket:15e7,investmentPercentage:25,hasBuilderBasket:!0,builderPercentage:50,builderStarting:0,crossDefaultThreshold:25e6,changeOfControlTrigger:"majority"}},{id:"project-finance",name:"Project Finance Facility",description:"Non-recourse project finance with construction/operations phases, milestones, DSCR/LLCR covenants, reserves, and waterfall distribution.",industry:"Project Finance",complexity:"advanced",icon:"Zap",features:["Construction → Operations → Tail phases","Milestone tracking with longstop dates","DSCR & LLCR covenants","Distribution lock-up mechanism","DSRA and MRA reserve accounts","Waterfall cash distribution","Conditions precedent for draws"],defaultValues:{projectName:"Greenfield Solar Project",facilityAmount:2e8,projectType:"solar",constructionEndDate:"2027-06-30",constructionLongstop:"2027-12-31",tailEndDate:"2045-12-31",minDSCR:1.2,lockupDSCR:1.1,defaultDSCR:1.05,hasLLCR:!0,minLLCR:1.3,milestone1Name:"FoundationComplete",milestone1Target:"2026-06-30",milestone1Longstop:"2026-09-30",milestone2Name:"MechanicalCompletion",milestone2Target:"2027-03-31",milestone2Longstop:"2027-06-30",dsraMonths:6,dsraMinimum:5e6,hasMRA:!0,mraTarget:3e6,equityDistributionTest:"dscr_and_reserves"}},{id:"real-estate",name:"Commercial Real Estate Loan",description:"CRE mortgage loan with LTV, DSCR, debt yield, and tenant concentration covenants. Includes reserves and lease approval thresholds.",industry:"Real Estate",complexity:"standard",icon:"Building",features:["LTV, DSCR, and debt yield covenants","Tenant concentration limits","Minimum occupancy requirements","Capital improvement and TI/LC baskets","Replacement and escrow reserve accounts","Major lease approval conditions"],defaultValues:{propertyName:"Metro Office Tower LLC",loanAmount:1e8,propertyType:"office",appraised_value:15e7,maxLTV:65,minDSCR:1.25,hasDebtYield:!0,minDebtYield:8,hasTenantConcentration:!0,maxTenantConcentration:30,minOccupancy:80,capExBasket:5e6,tiLcBasket:3e6,replacementReserve:25e4,hasTaxInsuranceEscrow:!0,majorLeaseThreshold:2e6,paymentGracePeriod:5}}],z={Building2:G,Building:ne,TrendingUp:re,Zap:se},Y={starter:{label:"Starter",variant:"muted"},standard:{label:"Standard",variant:"info"},advanced:{label:"Advanced",variant:"warning"}},Ae={Corporate:"from-blue-500/20 to-blue-600/5","Leveraged Finance":"from-purple-500/20 to-purple-600/5","Project Finance":"from-amber-500/20 to-amber-600/5","Real Estate":"from-emerald-500/20 to-emerald-600/5"},Ee={Corporate:"border-blue-500/30","Leveraged Finance":"border-purple-500/30","Project Finance":"border-amber-500/30","Real Estate":"border-emerald-500/30"},Q={Corporate:"text-blue-400","Leveraged Finance":"text-purple-400","Project Finance":"text-amber-400","Real Estate":"text-emerald-400"};function Le({onSelectTemplate:m,onClose:x}){const[s,n]=d.useState(null),[a,j]=d.useState(null),[b,v]=d.useState(!1),u=d.useCallback(r=>{n(r),w(r)},[]),N=d.useCallback(()=>{s&&m(s.id,s.defaultValues)},[s,m]),C=d.useCallback(async()=>{if(a)try{await navigator.clipboard.writeText(a),v(!0),setTimeout(()=>v(!1),2e3)}catch{}},[a]),w=r=>{const l=[],t=r.defaultValues;switch(r.id){case"corporate-revolver":l.push(`// ${t.borrowerName} — Revolving Credit Facility`,`// Facility Amount: $${t.facilityAmount.toLocaleString()}`,"","DEFINE EBITDA AS","  net_income + interest_expense + tax_expense + depreciation + amortization","  EXCLUDING extraordinary_items","","DEFINE Leverage AS TotalDebt / EBITDA","","COVENANT MaxLeverage",`  REQUIRES Leverage <= ${t.maxLeverage}`,`  TESTED ${t.covenantFrequency}`,`  CURE EquityCure MAX_USES ${t.cureMaxUses} OVER life_of_facility`,"  BREACH -> UnmaturedDefault","","COVENANT MinInterestCoverage",`  REQUIRES InterestCoverage >= ${t.minInterestCoverage}`,`  TESTED ${t.covenantFrequency}`,"","BASKET GeneralInvestments",`  CAPACITY $${t.generalInvestmentBasket.toLocaleString()}`,"","BASKET PermittedAcquisitions",`  CAPACITY $${t.permittedAcquisitionBasket.toLocaleString()}`,"  SUBJECT TO NoDefault, ProFormaCompliance","","// ... and 50+ more lines of definitions, baskets,","//     conditions, prohibitions, and events");break;case"term-loan-b":l.push(`// ${t.borrowerName} — Term Loan B (Covenant-Lite)`,`// Facility Amount: $${t.facilityAmount.toLocaleString()}`,"","DEFINE Leverage AS TotalDebt / EBITDA","DEFINE SecuredLeverage AS SecuredDebt / EBITDA","","// Incurrence-only tests (no maintenance covenants)","CONDITION IncurrenceLeverageTest AS",`  Leverage <= ${t.incurrenceLeverage} AND SecuredLeverage <= ${t.securedLeverageCap}`,"","BASKET IncrementalDebt",`  CAPACITY $${t.facilityAmount.toLocaleString()}`,"  SUBJECT TO IncurrenceLeverageTest","","// ... and 40+ more lines");break;case"project-finance":l.push(`// ${t.projectName} — Project Finance Facility`,`// Facility Amount: $${t.facilityAmount.toLocaleString()}`,"","PHASE Construction",`  UNTIL "${t.constructionEndDate}"`,`  REQUIRED ${t.milestone1Name}, ${t.milestone2Name}`,"","PHASE Operations",`  FROM "${t.constructionEndDate}"`,"  COVENANTS ACTIVE MinDSCR, DistributionLockup, MinLLCR","",`MILESTONE ${t.milestone1Name}`,`  TARGET "${t.milestone1Target}"`,`  LONGSTOP "${t.milestone1Longstop}"`,"","COVENANT MinDSCR",`  REQUIRES DSCR >= ${t.minDSCR}`,"  TESTED QUARTERLY","","WATERFALL OperatingCashflow","  TIER 1 PAY operating_expenses FROM revenue","  TIER 2 PAY DebtService FROM operating_cashflow","","// ... and 60+ more lines");break;case"real-estate":l.push(`// ${t.propertyName} — Commercial Real Estate Loan`,`// Loan Amount: $${t.loanAmount.toLocaleString()}`,"","DEFINE NOI AS","  gross_rental_income + other_income - operating_expenses - management_fees","","DEFINE LTV AS outstanding_loan_balance / appraised_value","DEFINE DSCR AS NOI / DebtService","","COVENANT MaxLTV",`  REQUIRES LTV <= ${t.maxLTV/100}`,"  TESTED QUARTERLY","","COVENANT MinDSCR",`  REQUIRES DSCR >= ${t.minDSCR}`,"  TESTED QUARTERLY","","COVENANT MaxTenantConcentration",`  REQUIRES TenantConcentration <= ${t.maxTenantConcentration/100}`,"","// ... and 40+ more lines");break}j(l.join(`
`))};if(s){const r=z[s.icon]||E,l=Y[s.complexity],t=Q[s.industry]||"text-gold-400";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>{n(null),j(null)},className:"flex items-center gap-2 text-sm text-text-tertiary hover:text-text-primary transition-colors",children:[e.jsx(O,{className:"w-4 h-4 rotate-180"}),"Back to templates"]}),e.jsx("div",{className:"flex items-center gap-2",children:x&&e.jsx(g,{variant:"ghost",size:"sm",onClick:x,children:e.jsx(R,{className:"w-4 h-4"})})})]}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl bg-surface-2 flex items-center justify-center ${t}`,children:e.jsx(r,{className:"w-6 h-6"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-xl font-display font-semibold text-text-primary",children:s.name}),e.jsx(L,{variant:(l==null?void 0:l.variant)||"muted",size:"sm",children:(l==null?void 0:l.label)||s.complexity})]}),e.jsx("p",{className:"text-sm text-text-tertiary mt-1",children:s.description})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:s.features.map((f,y)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm text-text-secondary",children:[e.jsx(_,{className:"w-3.5 h-3.5 text-success flex-shrink-0"}),f]},y))}),a&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-text-secondary",children:"Generated Code Preview"}),e.jsx(g,{variant:"ghost",size:"sm",icon:b?e.jsx(_,{className:"w-3.5 h-3.5 text-success"}):e.jsx(ie,{className:"w-3.5 h-3.5"}),onClick:C,children:b?"Copied":"Copy"})]}),e.jsx("div",{className:"bg-surface-0 border border-border-default rounded-lg overflow-hidden",children:e.jsx("pre",{className:"p-4 text-xs font-mono text-text-secondary overflow-x-auto max-h-64 overflow-y-auto",children:a})})]}),e.jsxs("div",{className:"flex items-center gap-3 pt-2 border-t border-border-default",children:[e.jsx(g,{onClick:N,icon:e.jsx(le,{className:"w-4 h-4"}),children:"Use This Template"}),e.jsx(g,{variant:"secondary",onClick:C,icon:e.jsx(oe,{className:"w-4 h-4"}),children:"Download .proviso"}),e.jsx("div",{className:"flex-1"}),e.jsx("span",{className:"text-xs text-text-muted",children:"All values can be customized after selection"})]})]})}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-display font-semibold text-text-primary flex items-center gap-2",children:[e.jsx(E,{className:"w-5 h-5 text-gold-500"}),"Deal Templates"]}),e.jsx("p",{className:"text-sm text-text-tertiary mt-1",children:"Start with a proven structure. Pick a template, customize the parameters, and get a complete .proviso file."})]}),x&&e.jsx(g,{variant:"ghost",size:"sm",onClick:x,children:e.jsx(R,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:De.map(r=>{const l=z[r.icon]||E,t=Y[r.complexity],f=Ae[r.industry]||"from-gold-500/20 to-gold-600/5",y=Ee[r.industry]||"border-gold-500/30",h=Q[r.industry]||"text-gold-400";return e.jsx("button",{onClick:()=>u(r),className:"text-left group",children:e.jsx(P,{className:`h-full border ${y} hover:border-gold-500/50 transition-all duration-200 group-hover:shadow-lg group-hover:shadow-gold-500/5`,children:e.jsxs(M,{children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${f} opacity-0 group-hover:opacity-100 transition-opacity duration-300 rounded-xl`}),e.jsxs("div",{className:"relative space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg bg-surface-2 flex items-center justify-center ${h}`,children:e.jsx(l,{className:"w-5 h-5"})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(L,{variant:(t==null?void 0:t.variant)||"muted",size:"sm",children:(t==null?void 0:t.label)||r.complexity})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-text-primary group-hover:text-gold-400 transition-colors",children:r.name}),e.jsx("p",{className:"text-xs text-text-muted mt-0.5",children:r.industry})]}),e.jsx("p",{className:"text-sm text-text-tertiary line-clamp-2",children:r.description}),e.jsxs("div",{className:"flex items-center gap-4 pt-1",children:[e.jsxs("div",{className:"flex items-center gap-1 text-xs text-text-muted",children:[e.jsx(ce,{className:"w-3 h-3"}),r.features.length," features"]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-text-muted",children:[e.jsx(de,{className:"w-3 h-3"}),Object.keys(r.defaultValues).length," parameters"]})]}),e.jsxs("div",{className:"flex items-center justify-end text-xs text-gold-500 opacity-0 group-hover:opacity-100 transition-opacity",children:["Preview & customize",e.jsx(O,{className:"w-3 h-3 ml-1"})]})]})]})})},r.id)})}),e.jsx("div",{className:"text-center text-xs text-text-muted py-2",children:"Each template generates a complete .proviso file — typically 80–120 lines of executable agreement code"})]})}const Re=[{value:"corporate",label:"Corporate Facility"},{value:"project_finance",label:"Project Finance"}],ke=[{value:"25000000",label:"$25,000,000"},{value:"50000000",label:"$50,000,000"},{value:"75000000",label:"$75,000,000"},{value:"100000000",label:"$100,000,000"},{value:"150000000",label:"$150,000,000"},{value:"200000000",label:"$200,000,000"},{value:"250000000",label:"$250,000,000"},{value:"500000000",label:"$500,000,000"}];function Ie({isOpen:m,onClose:x,onSubmit:s}){const[n,a]=d.useState("choose"),[j,b]=d.useState(""),[v,u]=d.useState("corporate"),[N,C]=d.useState("100000000"),[w,r]=d.useState(""),[l,t]=d.useState(""),[f,y]=d.useState(""),[h,p]=d.useState({}),S=o=>{o.preventDefault();const c={};if(j.trim()||(c.name="Deal name is required"),w.trim()||(c.borrowerName="Borrower name is required"),N||(c.facilityAmount="Facility amount is required"),Object.keys(c).length>0){p(c);return}const F={name:j.trim(),dealType:v,facilityAmount:parseInt(N,10),borrowerName:w.trim(),agentName:l.trim()||void 0,targetClosingDate:f?new Date(f):null};s(F),T()},k=(o,c)=>{const F={"corporate-revolver":"Corporate Revolving Credit Facility","term-loan-b":"Term Loan B","project-finance":"Project Finance Facility","real-estate":"Commercial Real Estate Loan"},K={"corporate-revolver":"corporate","term-loan-b":"corporate","project-finance":"project_finance","real-estate":"corporate"},U=c.borrowerName||c.projectName||c.propertyName||"New Deal",X=c.facilityAmount||c.loanAmount||1e8,J={name:`${U} — ${F[o]||"Deal"}`,dealType:K[o]||"corporate",facilityAmount:X,borrowerName:U,targetClosingDate:null};s(J),T()},T=()=>{a("choose"),b(""),u("corporate"),C("100000000"),r(""),t(""),y(""),p({}),x()},I=n==="template"?"xl":"lg",i=n==="blank"?e.jsxs(e.Fragment,{children:[e.jsx(g,{variant:"ghost",onClick:()=>a("choose"),children:"Back"}),e.jsx(g,{type:"submit",form:"create-deal-form",children:"Create Deal"})]}):n==="choose"?e.jsx(g,{variant:"ghost",onClick:T,children:"Cancel"}):null;return e.jsxs(ye,{isOpen:m,onClose:T,title:n==="choose"?"Create New Deal":n==="blank"?"Create Blank Deal":"Choose a Template",size:I,footer:i,children:[n==="choose"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-text-tertiary",children:"How would you like to start your new deal?"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("button",{onClick:()=>a("blank"),className:"group text-left",children:e.jsxs("div",{className:"p-6 rounded-xl border border-border-default hover:border-gold-500/50 bg-surface-1 hover:bg-surface-2 transition-all duration-200 h-full",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-surface-3 flex items-center justify-center mb-4 group-hover:bg-gold-500/10 transition-colors",children:e.jsx(H,{className:"w-5 h-5 text-text-tertiary group-hover:text-gold-500 transition-colors"})}),e.jsx("h3",{className:"font-semibold text-text-primary mb-1",children:"Blank Deal"}),e.jsx("p",{className:"text-sm text-text-tertiary",children:"Start from scratch with basic deal information. Build your agreement manually."})]})}),e.jsx("button",{onClick:()=>a("template"),className:"group text-left",children:e.jsxs("div",{className:"p-6 rounded-xl border border-gold-500/30 hover:border-gold-500/60 bg-surface-1 hover:bg-surface-2 transition-all duration-200 h-full relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-gold-500/5 to-transparent"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gold-500/10 flex items-center justify-center mb-4",children:e.jsx(E,{className:"w-5 h-5 text-gold-500"})}),e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-text-primary",children:"From Template"}),e.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-wider text-gold-500 bg-gold-500/10 px-1.5 py-0.5 rounded",children:"New"})]}),e.jsx("p",{className:"text-sm text-text-tertiary",children:"Pick a proven deal structure. Get a complete .proviso file with covenants, baskets, and events."}),e.jsx("div",{className:"mt-3 text-xs text-gold-500",children:"4 templates available →"})]})]})})]})]}),n==="blank"&&e.jsxs("form",{id:"create-deal-form",onSubmit:S,className:"space-y-6",children:[e.jsx("div",{children:e.jsx(D,{label:"Deal Name",placeholder:"ABC Acquisition Facility",value:j,onChange:o=>{b(o.target.value),h.name&&p(c=>({...c,name:""}))},error:h.name,icon:e.jsx(V,{className:"w-4 h-4"})})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1.5",children:"Facility Type"}),e.jsx(q,{value:v,onChange:o=>u(o.target.value),options:Re})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1.5",children:"Facility Amount"}),e.jsx(q,{value:N,onChange:o=>{C(o.target.value),h.facilityAmount&&p(c=>({...c,facilityAmount:""}))},options:ke,error:h.facilityAmount})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsx(D,{label:"Borrower Name",placeholder:"ABC Holdings, Inc.",value:w,onChange:o=>{r(o.target.value),h.borrowerName&&p(c=>({...c,borrowerName:""}))},error:h.borrowerName,icon:e.jsx(G,{className:"w-4 h-4"})})}),e.jsx("div",{children:e.jsx(D,{label:"Administrative Agent",placeholder:"First National Bank",value:l,onChange:o=>t(o.target.value),helpText:"Optional",icon:e.jsx(me,{className:"w-4 h-4"})})})]}),e.jsx("div",{className:"w-1/2",children:e.jsx(D,{type:"date",label:"Target Closing Date",value:f,onChange:o=>y(o.target.value),helpText:"Optional",icon:e.jsx(xe,{className:"w-4 h-4"})})}),e.jsx("div",{className:"bg-slate-900/50 border border-slate-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gold-500/10 flex items-center justify-center flex-shrink-0",children:e.jsx(V,{className:"w-4 h-4 text-gold-500"})}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-white",children:[v==="corporate"?"Corporate Facility":"Project Finance"," ","Template"]}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:v==="corporate"?"Starts with standard corporate covenants: leverage ratio, interest coverage, and investment baskets.":"Starts with project finance structure: phases, milestones, reserves, and waterfall distribution."})]})]})})]}),n==="template"&&e.jsx(Le,{onSelectTemplate:k,onClose:()=>a("choose")})]})}const Fe={draft:{label:"Draft",variant:"muted"},negotiation:{label:"Negotiation",variant:"warning"},closing:{label:"Closing",variant:"info"},active:{label:"Active",variant:"success"},matured:{label:"Matured",variant:"muted"}};function $e(m){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",notation:"compact",maximumFractionDigits:1}).format(m)}function Be(m){return m?new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(m):"-"}function Qe(){const m=ee(),{deals:x,activities:s,createDeal:n,getCurrentVersion:a,clearActivities:j,resetToDefaults:b,loadScenario:v}=Z();d.useEffect(()=>{Object.keys(W).forEach(i=>{v(i)})},[v]);const[u]=d.useState(!1),[N,C]=d.useState(!1),[w,r]=d.useState(!1),[l,t]=d.useState(""),[f,y]=d.useState("all"),h=x,p=d.useMemo(()=>({all:h.length,negotiation:h.filter(i=>i.status==="negotiation").length,closing:h.filter(i=>i.status==="closing").length,active:h.filter(i=>i.status==="active").length}),[h]),S=d.useMemo(()=>h.filter(i=>{if(l){const o=l.toLowerCase();if(!i.name.toLowerCase().includes(o))return!1}return!(f!=="all"&&i.status!==f)}),[h,l,f]),k=[{id:"all",label:"All Deals",count:p.all},{id:"negotiation",label:"Negotiation",count:p.negotiation},{id:"closing",label:"Closing",count:p.closing},{id:"active",label:"Active",count:p.active}],T=()=>{t(""),y("all")},I=i=>{const o=n(i);m(`/deals/${o.id}/negotiate`)};return e.jsxs("div",{className:"min-h-screen bg-surface-0",children:[e.jsx(Ce,{breadcrumbs:[{label:"Deal Pipeline"}]}),e.jsxs("main",{className:"max-w-screen-2xl mx-auto px-8 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h1",{className:"text-2xl font-display font-semibold text-text-primary",children:"Deal Pipeline"}),e.jsx(L,{variant:"gold",size:"sm",children:"v2.1"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{variant:"ghost",size:"sm",icon:e.jsx(ue,{className:"w-4 h-4"}),onClick:b,title:"Reset demo data",children:"Reset"}),e.jsxs(g,{variant:"ghost",size:"sm",icon:e.jsx(he,{className:"w-4 h-4"}),onClick:()=>r(!0),children:["Activity",s.length>0&&e.jsx("span",{className:"ml-1 text-xs bg-gold-500 text-navy-900 px-1.5 py-0.5 rounded-full",children:s.length})]}),e.jsx(g,{icon:e.jsx(pe,{className:"w-4 h-4"}),onClick:()=>C(!0),children:"New Deal"})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-8",children:[e.jsx(A,{icon:e.jsx(H,{className:"w-5 h-5"}),label:"Total Deals",value:p.all.toString()}),e.jsx(A,{icon:e.jsx(ge,{className:"w-5 h-5"}),label:"In Negotiation",value:p.negotiation.toString(),variant:"warning"}),e.jsx(A,{icon:e.jsx(ve,{className:"w-5 h-5"}),label:"Closing",value:p.closing.toString(),variant:"info"}),e.jsx(A,{icon:e.jsx(fe,{className:"w-5 h-5"}),label:"Active",value:p.active.toString(),variant:"success"})]}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsx(we,{searchValue:l,onSearchChange:t,searchPlaceholder:"Search deals by name..."}),e.jsx(Se,{options:k,value:f,onChange:y})]}),e.jsx("div",{className:"space-y-4",children:u?e.jsxs(e.Fragment,{children:[e.jsx(B,{}),e.jsx(B,{}),e.jsx(B,{})]}):S.length===0?h.length===0?e.jsx(je,{itemType:"deals",onCreate:()=>{},createLabel:"Create your first deal"}):e.jsx(be,{searchTerm:l||void 0,onClear:T}):S.map(i=>{const o=Fe[i.status],c=a(i.id);return e.jsx(P,{className:"hover:bg-surface-2/50 transition-colors",children:e.jsx(M,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:i.name}),e.jsx(L,{variant:o.variant,dot:!0,children:o.label})]}),e.jsxs("div",{className:"flex items-center gap-6 text-sm text-text-tertiary",children:[e.jsx("span",{children:$e(i.facilityAmount)}),e.jsx("span",{className:"text-text-muted",children:"|"}),e.jsxs("span",{children:["Target Close: ",Be(i.targetClosingDate)]}),c&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-text-muted",children:"|"}),e.jsxs("span",{children:[c.versionLabel," (v",c.versionNumber,")"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{to:`/deals/${i.id}/negotiate`,children:e.jsx(g,{variant:"ghost",size:"sm",children:"Negotiate"})}),e.jsx($,{to:`/deals/${i.id}/closing`,children:e.jsx(g,{variant:"ghost",size:"sm",children:"Closing"})}),e.jsx($,{to:`/deals/${i.id}/monitor`,children:e.jsx(g,{variant:"ghost",size:"sm",children:"Monitor"})}),e.jsx(O,{className:"w-5 h-5 text-text-muted"})]})]})})},i.id)})})]}),e.jsx(Ie,{isOpen:N,onClose:()=>C(!1),onSubmit:I}),e.jsx(Ne,{isOpen:w,onClose:()=>r(!1),activities:s,onClear:j})]})}function A({icon:m,label:x,value:s,variant:n="default"}){const a={default:"text-text-tertiary",success:"text-success",warning:"text-warning",info:"text-gold-500"};return e.jsx(P,{children:e.jsx(M,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:a[n],children:m}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-text-primary",children:s}),e.jsx("div",{className:"text-sm text-text-tertiary",children:x})]})]})})})}export{Qe as DealList,Qe as default};
